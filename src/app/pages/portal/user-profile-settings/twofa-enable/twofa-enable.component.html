<div class="card">
  <div class="card-header b-l-warning">
    {{ "Enable Two-Factor Authentication(2FA)" | translate }}
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-sm-9">
        <div class="row">
          <div class="col-sm-2 text-right">
            <i class="fa fa-envelope-square fa-3x text-warning"></i>
          </div>
          <div class="col-sm">
            <p class="m-b-0">{{ "Verification By Email" | translate }}</p>
            <p class="small">
              {{ "Enable to prevent unauthorized access to your account" | translate }}
            </p>
          </div>
        </div>
      </div>

      <div class="col-sm-3 text-right">
        <span *ngIf="!memberAccount.is2FAByEmailEnabled()">
          <button type="button" class="btn btn-primary" (click)="showEnableEmailTwofaModal()">
            {{ "Enable" | translate }}
          </button>
        </span>

        <span *ngIf="memberAccount.is2FAByEmailEnabled()">
          <button type="button" class="btn btn-danger" (click)="disable2FAByEmail()">
            {{ "Disable" | translate }}
          </button>
        </span>
      </div>
    </div>
    <!-- end of row -->
  </div>
</div>
<!-- end of card -->

<ng-template #enableEmailTwofaModal let-modal>
  <form class="form form-horizontal theme-form">
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">
        {{ "Enable E-Mail Verification" | translate }}
      </h4>

      <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="form-group row">
        <div class="col-lg-12">
          <p>
            {{ "Enter the 6-digit code sent to" | translate }} <em>{{ email }}</em>
          </p>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-sm-3 col-form-label">
          {{ "E-Mail Verification Code" | translate }}
        </label>
        <div class="col-sm-6">
          <input type="text" class="form-control" [(ngModel)]="code" placeholder="e.g. 014821" />
        </div>
        <div class="col-sm">
          <button class="btn btn-primary btn-sm" [disabled]="twoFaService.requesting"
                  (click)="getEmailVerificationCode()">
            {{ "Resend Code" | translate }}
            <span *ngIf="twoFaService.requesting" class="fa fa-spinner fa-spin"></span>
          </button>
        </div>
      </div>
      <!-- end of form-group -->

      <div class="form-group text-center">
        <hr />
        <button type="submit" class="btn btn-warning mr-2" (click)="submitEmailVerification()">
          {{ "Submit" | translate }}
        </button>
        <button type="button" class="btn btn-outline-danger" (click)="modal.close('Save click')">
          {{ "Cancel" | translate }}
        </button>
      </div>
      <!-- end of form-group -->
    </div>
    <!-- end of modal-body -->
  </form>
</ng-template>
